@page "/admin/staff/create"
@rendermode InteractiveServer
@inject NavigationManager Navigation
@using System.ComponentModel.DataAnnotations

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h4 class="mb-0">
                        <i class="bi bi-person-plus-fill me-2"></i>
                        Add New Staff Member
                    </h4>
                </div>
                <div class="card-body">
                    <EditForm Model="@staff" OnValidSubmit="HandleSubmit">
                        <DataAnnotationsValidator />
                        <ValidationSummary class="text-danger mb-3" />

                        <div class="row">
                            <!-- Full Name -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Full Name *</label>
                                <InputText @bind-Value="staff.FullName" class="form-control" placeholder="Enter full name" />
                                <ValidationMessage For="@(() => staff.FullName)" />
                            </div>

                            <!-- Role -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Role *</label>
                                <InputSelect @bind-Value="staff.Role" class="form-select">
                                    <option value="">Select Role</option>
                                    <option value="Doctor">Doctor</option>
                                    <option value="Nurse">Nurse</option>
                                    <option value="Receptionist">Receptionist</option>
                                    <option value="Administrator">Administrator</option>
                                    <option value="Technician">Technician</option>
                                    <option value="Therapist">Therapist</option>
                                </InputSelect>
                                <ValidationMessage For="@(() => staff.Role)" />
                            </div>

                            <!-- Specialization -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Specialization *</label>
                                <InputText @bind-Value="staff.Specialization" class="form-control" placeholder="e.g., Cardiology, Emergency Care" />
                                <ValidationMessage For="@(() => staff.Specialization)" />
                            </div>

                            <!-- Department -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Department</label>
                                <InputSelect @bind-Value="staff.Department" class="form-select">
                                    <option value="">Select Department</option>
                                    <option value="Emergency">Emergency</option>
                                    <option value="ICU">ICU</option>
                                    <option value="Surgery">Surgery</option>
                                    <option value="Pediatrics">Pediatrics</option>
                                    <option value="Cardiology">Cardiology</option>
                                    <option value="Neurology">Neurology</option>
                                    <option value="Orthopedics">Orthopedics</option>
                                    <option value="Radiology">Radiology</option>
                                    <option value="Laboratory">Laboratory</option>
                                    <option value="Administration">Administration</option>
                                </InputSelect>
                            </div>

                            <!-- Phone -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Phone *</label>
                                <InputText @bind-Value="staff.Phone" class="form-control" placeholder="+46 70 123 4567" />
                                <ValidationMessage For="@(() => staff.Phone)" />
                            </div>

                            <!-- Email -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Email *</label>
                                <InputText @bind-Value="staff.Email" type="email" class="form-control" placeholder="email@hospital.com" />
                                <ValidationMessage For="@(() => staff.Email)" />
                            </div>

                            <!-- License Number -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">License Number</label>
                                <InputText @bind-Value="staff.LicenseNumber" class="form-control" placeholder="MD-2024-1234" />
                                <small class="form-text text-muted">Required for doctors and nurses</small>
                            </div>

                            <!-- Hourly Rate -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Hourly Rate (SEK) *</label>
                                <InputNumber @bind-Value="staff.HourlyRate" class="form-control" step="0.01" placeholder="0.00" />
                                <ValidationMessage For="@(() => staff.HourlyRate)" />
                            </div>

                            <!-- Hired Date -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Hired Date *</label>
                                <InputDate @bind-Value="staff.HiredDate" class="form-control" />
                                <ValidationMessage For="@(() => staff.HiredDate)" />
                            </div>

                            <!-- Employment Type -->
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Employment Type *</label>
                                <InputSelect @bind-Value="staff.EmploymentType" class="form-select">
                                    <option value="">Select Type</option>
                                    <option value="Full-Time">Full-Time</option>
                                    <option value="Part-Time">Part-Time</option>
                                    <option value="Contract">Contract</option>
                                    <option value="Intern">Intern</option>
                                </InputSelect>
                                <ValidationMessage For="@(() => staff.EmploymentType)" />
                            </div>

                            <!-- Address -->
                            <div class="col-md-12 mb-3">
                                <label class="form-label">Address</label>
                                <InputText @bind-Value="staff.Address" class="form-control" placeholder="Street, City, Postal Code" />
                            </div>

                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-2 mt-4">
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-check-circle me-1"></i> Create Staff Member
                            </button>
                            <button type="button" class="btn btn-secondary" @onclick="Cancel">
                                <i class="bi bi-x-circle me-1"></i> Cancel
                            </button>
                        </div>
                    </EditForm>
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private StaffCreateModel staff = new()
    {
        HiredDate = DateTime.Today,
        HourlyRate = 0.00m
    };

    private void HandleSubmit()
    {
        // In real app, save to database via service
        // Example:
        // await StaffService.CreateAsync(staff);

        // For demo, just navigate back to list
        Navigation.NavigateTo("/Admin/Staff");
    }

    private void Cancel()
    {
        Navigation.NavigateTo("/Admin/Staff");
    }

    public class StaffCreateModel
    {
        [Required(ErrorMessage = "Full name is required")]
        [StringLength(100, MinimumLength = 2, ErrorMessage = "Name must be between 2 and 100 characters")]
        public string FullName { get; set; } = string.Empty;

        [Required(ErrorMessage = "Role is required")]
        public string Role { get; set; } = string.Empty;

        [Required(ErrorMessage = "Specialization is required")]
        [StringLength(100, ErrorMessage = "Specialization cannot exceed 100 characters")]
        public string Specialization { get; set; } = string.Empty;

        [StringLength(50, ErrorMessage = "Department cannot exceed 50 characters")]
        public string? Department { get; set; }

        [Required(ErrorMessage = "Phone is required")]
        [Phone(ErrorMessage = "Invalid phone number format")]
        [StringLength(20, ErrorMessage = "Phone number cannot exceed 20 characters")]
        public string Phone { get; set; } = string.Empty;

        [Required(ErrorMessage = "Email is required")]
        [EmailAddress(ErrorMessage = "Invalid email address format")]
        [StringLength(100, ErrorMessage = "Email cannot exceed 100 characters")]
        public string Email { get; set; } = string.Empty;

        [StringLength(50, ErrorMessage = "License number cannot exceed 50 characters")]
        public string? LicenseNumber { get; set; }

        [Required(ErrorMessage = "Hourly rate is required")]
        [Range(0.01, 10000, ErrorMessage = "Hourly rate must be between 0.01 and 10,000")]
        public decimal HourlyRate { get; set; }

        [Required(ErrorMessage = "Hired date is required")]
        [DataType(DataType.Date)]
        public DateTime HiredDate { get; set; }

        [Required(ErrorMessage = "Employment type is required")]
        public string EmploymentType { get; set; } = string.Empty;

        [StringLength(200, ErrorMessage = "Address cannot exceed 200 characters")]
        public string? Address { get; set; }

    }
}