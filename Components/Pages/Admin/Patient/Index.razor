@page "/Admin/Patient"
@rendermode InteractiveServer

<div class="container-fluid mt-4">
    <h2 class="mb-4">Hospital Management System - Demo</h2>

    <!-- Patients Section -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
                <i class="bi bi-heart-pulse-fill me-2"></i>
                Total Patients: <span class="badge bg-light text-primary">@patients.Count</span>
            </h5>
            <button class="btn btn-light btn-sm" @onclick='() => Navigation.NavigateTo("/admin/patient/create")'>
    <i class="bi bi-plus-circle me-1"></i> Add Patient
</button>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Patient ID</th>
                            <th>Full Name</th>
                            <th>Date of Birth</th>
                            <th>Blood Group</th>
                            <th>Phone</th>
                            <th>Email</th>
                            <th>Emergency Contact</th>
                            <th>Registered</th>
                            <th style="width: 150px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var patient in patients)
                        {
                            <tr>
                                <td><span class="badge bg-info">@patient.PatientId</span></td>
                                <td><strong>@patient.FullName</strong></td>
                                <td>@patient.DateOfBirth.ToString("yyyy-MM-dd")</td>
                                <td><span class="badge bg-danger">@patient.BloodGroup</span></td>
                                <td>@patient.Phone</td>
                                <td>@patient.Email</td>
                                <td>@patient.EmergencyContact</td>
                                <td>@patient.CreatedAt.ToString("yyyy-MM-dd")</td>
                                <td>
                                    <div class="btn-group btn-group-sm" role="group">
                                        <button class="btn btn-outline-primary" 
                                                @onclick="() => ViewPatient(patient.PatientId)"
                                                title="View Details">
                                            <i class="bi bi-eye"></i>
                                        </button>
                                        <button class="btn btn-outline-warning" 
                                                @onclick="() => EditPatient(patient.PatientId)"
                                                title="Edit">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                        <button class="btn btn-outline-danger" 
                                                @onclick="() => DeletePatient(patient.PatientId)"
                                                title="Delete">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    
</div>

@code {
    // Patient Demo Model
    public class PatientDemo
    {
        public int PatientId { get; set; }
        public string FullName { get; set; } = string.Empty;
        public DateTime DateOfBirth { get; set; }
        public string BloodGroup { get; set; } = string.Empty;
        public string Phone { get; set; } = string.Empty;
        public string Email { get; set; } = string.Empty;
        public string EmergencyContact { get; set; } = string.Empty;
        public DateTime CreatedAt { get; set; }
    }

    private List<PatientDemo> patients = new();

    protected override void OnInitialized()
    {
        // Initialize hardcoded patient data
        patients = new List<PatientDemo>
        {
            new PatientDemo
            {
                PatientId = 1001,
                FullName = "Emma Johnson",
                DateOfBirth = new DateTime(1985, 5, 15),
                BloodGroup = "A+",
                Phone = "+46 70 123 4567",
                Email = "emma.johnson@email.com",
                EmergencyContact = "+46 70 987 6543",
                CreatedAt = new DateTime(2024, 1, 15)
            },
            new PatientDemo
            {
                PatientId = 1002,
                FullName = "Michael Anderson",
                DateOfBirth = new DateTime(1990, 8, 22),
                BloodGroup = "O+",
                Phone = "+46 70 234 5678",
                Email = "michael.anderson@email.com",
                EmergencyContact = "+46 70 876 5432",
                CreatedAt = new DateTime(2024, 2, 20)
            },
            new PatientDemo
            {
                PatientId = 1003,
                FullName = "Sofia Bergström",
                DateOfBirth = new DateTime(1978, 3, 10),
                BloodGroup = "B+",
                Phone = "+46 70 345 6789",
                Email = "sofia.bergstrom@email.com",
                EmergencyContact = "+46 70 765 4321",
                CreatedAt = new DateTime(2024, 3, 5)
            },
            new PatientDemo
            {
                PatientId = 1004,
                FullName = "Lars Svensson",
                DateOfBirth = new DateTime(1995, 11, 30),
                BloodGroup = "AB+",
                Phone = "+46 70 456 7890",
                Email = "lars.svensson@email.com",
                EmergencyContact = "+46 70 654 3210",
                CreatedAt = new DateTime(2024, 4, 12)
            },
            new PatientDemo
            {
                PatientId = 1005,
                FullName = "Anna Lindqvist",
                DateOfBirth = new DateTime(1988, 7, 18),
                BloodGroup = "O-",
                Phone = "+46 70 567 8901",
                Email = "anna.lindqvist@email.com",
                EmergencyContact = "+46 70 543 2109",
                CreatedAt = new DateTime(2024, 5, 8)
            },
            new PatientDemo
            {
                PatientId = 1006,
                FullName = "Erik Johansson",
                DateOfBirth = new DateTime(1982, 12, 5),
                BloodGroup = "A-",
                Phone = "+46 70 678 9012",
                Email = "erik.johansson@email.com",
                EmergencyContact = "+46 70 432 1098",
                CreatedAt = new DateTime(2024, 6, 22)
            }
        };

    }

    // Patient Action Methods
    private void ViewPatient(int patientId)
    {
        Navigation.NavigateTo($"/admin/patient/view/{patientId}");
    }

    private void EditPatient(int patientId)
    {
        Navigation.NavigateTo($"/admin/patient/edit/{patientId}");
    }

    private void DeletePatient(int patientId)
    {
        // In real app, show confirmation dialog
        // For demo, just remove from list
        var patient = patients.FirstOrDefault(p => p.PatientId == patientId);
        if (patient != null)
        {
            patients.Remove(patient);
            StateHasChanged();
        }
    }
}